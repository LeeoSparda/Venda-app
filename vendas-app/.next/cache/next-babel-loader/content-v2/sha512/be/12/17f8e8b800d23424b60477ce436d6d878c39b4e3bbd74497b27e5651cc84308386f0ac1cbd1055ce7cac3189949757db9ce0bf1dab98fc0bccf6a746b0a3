{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"C:/TDS_projeto/vendas-app/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\TDS_projeto\\\\vendas-app\\\\src\\\\components\\\\produtos\\\\cadastro\\\\index.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { Layout, Input, InputMoney } from 'components';\nimport { useProdutoService } from 'app/services';\nimport { converterEmBigDecimal, formatReal } from 'app/util/money';\nimport * as yup from 'yup';\nimport Link from 'next/link';\nimport { useRouter } from 'next/router';\nvar msgCampoObrigatorio = \"Campo Obrigatório\";\nvar validationSchema = yup.object().shape({\n  sku: yup.string().trim().required(msgCampoObrigatorio),\n  nome: yup.string().trim().required(msgCampoObrigatorio),\n  descricao: yup.string().trim().required(msgCampoObrigatorio),\n  preco: yup.number().required(msgCampoObrigatorio).moreThan(0, \"Valor deve ser maior que 0,00 (Zero)\")\n});\nexport var CadastroProdutos = function CadastroProdutos() {\n  _s();\n\n  var service = useProdutoService();\n\n  var _useState = useState(''),\n      sku = _useState[0],\n      setSku = _useState[1];\n\n  var _useState2 = useState(''),\n      preco = _useState2[0],\n      setPreco = _useState2[1];\n\n  var _useState3 = useState(''),\n      nome = _useState3[0],\n      setNome = _useState3[1];\n\n  var _useState4 = useState(''),\n      descricao = _useState4[0],\n      setDescricao = _useState4[1];\n\n  var _useState5 = useState(''),\n      id = _useState5[0],\n      setId = _useState5[1];\n\n  var _useState6 = useState(''),\n      cadastro = _useState6[0],\n      setCadastro = _useState6[1];\n\n  var _useState7 = useState([]),\n      messages = _useState7[0],\n      setMessages = _useState7[1];\n\n  var _useState8 = useState({}),\n      errors = _useState8[0],\n      setErrors = _useState8[1];\n\n  var router = useRouter();\n  var queryId = router.query.id;\n  useEffect(function () {\n    if (queryId) {\n      service.carregarProduto(queryId).then(function (produtoEncontrado) {\n        setId(produtoEncontrado.id);\n        setSku(produtoEncontrado.sku);\n        setNome(produtoEncontrado.nome);\n        setDescricao(produtoEncontrado.descricao);\n        setPreco(formatReal(\"\".concat(produtoEncontrado.preco)));\n        setCadastro(produtoEncontrado.cadastro || '');\n      });\n    }\n  }, [queryId]);\n\n  var submit = function submit() {\n    var produto = {\n      id: id,\n      sku: sku,\n      preco: converterEmBigDecimal(preco),\n      nome: nome,\n      descricao: descricao\n    };\n    validationSchema.validate(produto).then(function (obj) {\n      setErrors({});\n\n      if (id) {\n        service.atualizar(produto).then(function (response) {\n          setMessages([{\n            tipo: \"success\",\n            texto: \"Produto atualizado com sucesso!\"\n          }]);\n        });\n      } else {\n        service.salvar(produto).then(function (produtoResposta) {\n          setId(produtoResposta.id);\n          setCadastro(produtoResposta.cadastro);\n          setMessages([{\n            tipo: \"success\",\n            texto: \"Produto Salvo com sucesso!\"\n          }]);\n        });\n      }\n    })[\"catch\"](function (err) {\n      var field = err.path;\n      var message = err.message;\n      setErrors(_defineProperty({}, field, message));\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    titulo: \"Produtos\",\n    mensagens: messages,\n    children: [id && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"columns\",\n      children: [/*#__PURE__*/_jsxDEV(Input, {\n        label: \"C\\xF3digo:\",\n        columnClasses: \"is-half\",\n        value: id,\n        id: \"inputId\",\n        disabled: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 21\n      }, _this), /*#__PURE__*/_jsxDEV(Input, {\n        label: \"Data Cadastro:\",\n        columnClasses: \"is-half\",\n        value: cadastro,\n        id: \"inputDataCadastro\",\n        disabled: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 21\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"columns\",\n      children: [/*#__PURE__*/_jsxDEV(Input, {\n        label: \"SKU: *\",\n        columnClasses: \"is-half\",\n        onChange: function onChange(e) {\n          return setSku(e.target.value);\n        },\n        value: sku,\n        id: \"inputSku\",\n        placeholder: \"Digite o SKU do produto\",\n        error: errors.sku\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(InputMoney, {\n        label: \"Pre\\xE7o: *\",\n        columnClasses: \"is-half\",\n        onChange: function onChange(e) {\n          return setPreco(e.target.value);\n        },\n        value: preco,\n        id: \"inputPreco\",\n        placeholder: \"Digite o Pre\\xE7o do produto\",\n        maxLength: 16,\n        error: errors.preco\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 17\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"columns\",\n      children: /*#__PURE__*/_jsxDEV(Input, {\n        label: \"Nome: *\",\n        columnClasses: \"is-full\",\n        onChange: function onChange(e) {\n          return setNome(e.target.value);\n        },\n        value: nome,\n        id: \"inputNome\",\n        placeholder: \"Digite o Nome do produto\",\n        error: errors.nome\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 12\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"columns\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field column is-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"label\",\n          htmlFor: \"inputDesc\",\n          children: \"Descri\\xE7\\xE3o: *\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 17\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"control\",\n          children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n            className: \"textarea\",\n            id: \"inputDesc\",\n            value: descricao,\n            onChange: function onChange(event) {\n              return setDescricao(event.target.value);\n            },\n            placeholder: \"Digite a Descri\\xE7\\xE3o detalhada do produto\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 21\n          }, _this), errors.descricao && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"help is-danger\",\n            children: errors.descricao\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 25\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 17\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 13\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 12\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field is-grouped\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"control is-link\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: submit,\n          className: \"button is-success\",\n          children: id ? \"Atualizar\" : \"Salvar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"control\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/consultas/produtos\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"button\",\n            children: \"Voltar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 25\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 17\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 12\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(CadastroProdutos, \"bn4y8WDi3gZOyopot1f1MColKVY=\", false, function () {\n  return [useProdutoService, useRouter];\n});\n\n_c = CadastroProdutos;\n\nvar _c;\n\n$RefreshReg$(_c, \"CadastroProdutos\");","map":{"version":3,"sources":["C:/TDS_projeto/vendas-app/src/components/produtos/cadastro/index.tsx"],"names":["useState","useEffect","Layout","Input","InputMoney","useProdutoService","converterEmBigDecimal","formatReal","yup","Link","useRouter","msgCampoObrigatorio","validationSchema","object","shape","sku","string","trim","required","nome","descricao","preco","number","moreThan","CadastroProdutos","service","setSku","setPreco","setNome","setDescricao","id","setId","cadastro","setCadastro","messages","setMessages","errors","setErrors","router","queryId","query","carregarProduto","then","produtoEncontrado","submit","produto","validate","obj","atualizar","response","tipo","texto","salvar","produtoResposta","err","field","path","message","e","target","value","event"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport { Layout, Input, InputMoney } from 'components'\nimport { useProdutoService } from 'app/services'\nimport { Produto } from 'app/models/produtos'\nimport { converterEmBigDecimal, formatReal } from 'app/util/money'\nimport { Alert } from 'components/common/message'\nimport * as yup from 'yup'\nimport Link from 'next/link'\nimport { useRouter } from 'next/router'\n\n\nconst msgCampoObrigatorio =\"Campo Obrigatório\";\n\nconst validationSchema = yup.object().shape({\n    sku: yup.string().trim().required(msgCampoObrigatorio),\n    nome: yup.string().trim().required(msgCampoObrigatorio),\n    descricao: yup.string().trim()\n                    .required(msgCampoObrigatorio),\n    preco: yup.number().required(msgCampoObrigatorio).moreThan(0, \"Valor deve ser maior que 0,00 (Zero)\")\n})\n\ninterface FormErros {\n    sku?: string;\n    nome?: string;\n    preco?: string;\n    descricao?: string;\n}\n\nexport const CadastroProdutos: React.FC = () => {\n\n    const service = useProdutoService()\n    const [ sku, setSku ] = useState<string>('')\n    const [ preco, setPreco ] = useState<string>('')\n    const [ nome, setNome ] = useState<string>('')\n    const [ descricao, setDescricao ] = useState<string>('')   \n    const [ id, setId ] = useState<string>('')\n    const [ cadastro, setCadastro ] = useState<string>('')\n    const [ messages, setMessages ] = useState<Array<Alert>>([])\n    const [ errors, setErrors ] = useState<FormErros>({})\n    const router = useRouter();\n    const { id: queryId  } = router.query;\n\n    useEffect( () => {        \n        if(queryId){\n            service.carregarProduto(queryId).then(produtoEncontrado => {\n                setId(produtoEncontrado.id)\n                setSku(produtoEncontrado.sku)\n                setNome(produtoEncontrado.nome)\n                setDescricao(produtoEncontrado.descricao)\n                setPreco( formatReal(`${produtoEncontrado.preco}`))\n                setCadastro(produtoEncontrado.cadastro || '')\n            })\n        } \n    } , [ queryId ] )\n\n    const submit = () => {\n        const produto: Produto = {\n            id,\n            sku, \n            preco: converterEmBigDecimal(preco), \n            nome, \n            descricao\n        }\n\n        validationSchema.validate(produto).then(obj => {\n            setErrors({})\n\n            if(id){\n                service\n                    .atualizar(produto)\n                    .then(response => {\n                        setMessages([{\n                            tipo: \"success\", texto: \"Produto atualizado com sucesso!\"\n                        }])\n                    })\n            }else{\n                \n                service\n                    .salvar(produto)\n                    .then(produtoResposta => {\n                        setId(produtoResposta.id)\n                        setCadastro(produtoResposta.cadastro)\n                        setMessages([{\n                            tipo: \"success\", texto: \"Produto Salvo com sucesso!\"\n                        }])\n                    })\n            }\n\n        }).catch(err => {\n            const field = err.path;\n            const message = err.message;\n\n            setErrors({\n                [field]: message\n            })\n        })\n\n\n    }\n\n    return (\n        <Layout titulo=\"Produtos\" mensagens={messages}>\n            {id &&\n                <div className=\"columns\">\n                    <Input label=\"Código:\" \n                        columnClasses=\"is-half\" \n                        value={id}\n                        id=\"inputId\"\n                        disabled={true}\n                        />\n\n                    <Input label=\"Data Cadastro:\" \n                        columnClasses=\"is-half\" \n                        value={cadastro}\n                        id=\"inputDataCadastro\"\n                        disabled\n                        />\n                </div>\n            }\n\n            <div className=\"columns\">\n                <Input label=\"SKU: *\" \n                       columnClasses=\"is-half\" \n                       onChange={ e => setSku(e.target.value)}\n                       value={sku}\n                       id=\"inputSku\"\n                       placeholder=\"Digite o SKU do produto\" \n                       error={errors.sku}\n                       />\n\n                <InputMoney label=\"Preço: *\" \n                       columnClasses=\"is-half\" \n                       onChange={e => setPreco(e.target.value)}\n                       value={preco}\n                       id=\"inputPreco\"\n                       placeholder=\"Digite o Preço do produto\" \n                       maxLength={16}\n                       error={errors.preco}\n                       />\n           </div>\n\n           <div className=\"columns\">\n                <Input label=\"Nome: *\" \n                       columnClasses=\"is-full\" \n                       onChange={e => setNome(e.target.value)}\n                       value={nome}\n                       id=\"inputNome\"\n                       placeholder=\"Digite o Nome do produto\"\n                       error={errors.nome}\n                    />\n           </div>\n\n           <div className=\"columns\">\n            <div className=\"field column is-full\">\n                <label className=\"label\" htmlFor=\"inputDesc\">Descrição: *</label>\n                <div className=\"control\">\n                    <textarea className=\"textarea\" \n                        id=\"inputDesc\" value={descricao}\n                        onChange={ event => setDescricao(event.target.value) }\n                        placeholder=\"Digite a Descrição detalhada do produto\" />\n                    {errors.descricao &&\n                        <p className=\"help is-danger\">{errors.descricao}</p>\n                    }\n                </div>\n            </div>\n           </div>\n\n           <div className=\"field is-grouped\">\n                <div className=\"control is-link\">\n                    <button onClick={submit} className=\"button is-success\">\n                        { id ? \"Atualizar\" : \"Salvar\" }                        \n                    </button>\n                </div>\n                <div className=\"control\">\n                    <Link href=\"/consultas/produtos\">\n                        <button className=\"button\">Voltar</button>\n                    </Link>\n                </div>\n           </div>\n\n        </Layout>\n    )\n}\n\n"]},"metadata":{},"sourceType":"module"}